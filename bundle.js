"use strict";(()=>{var i=window.document;var s=window.navigator;var c=class{constructor(a,r,n){return new window.XRWebGLLayer(a,r,n)}};function t(e){let a=document.getElementsByClassName("console-dom").item(0);a.textContent+=`${e}.    `}async function u(e){await s.xr.isSessionSupported(e)?t(`${e} is supported`):t(`${e} is not supported`)}function l(e){return i.featurePolicy.allowsFeature(e,window.origin)}async function g(e,a,r,n){let o={requiredFeatures:[...a],optionalFeatures:[...r,...n]};n.includes("depth-sensing")&&(o.depthSensing={usagePreference:["cpu-optimized","gpu-optimized"],dataFormatPreference:["luminance-alpha","float32"]}),Object.freeze(o);try{return await s.xr.requestSession(e,o)}catch(d){throw t(`requestSession error = ${d.toString()}`),new Error(d.toString())}}var y=i.createElement("canvas"),p=y.getContext("webgl2",{xrCompatible:!0}),m=new Map;m.set("inline",null);m.set("immersive-ar",null);m.set("immersive-vr",null);function S(e,a){let r=a.session;r.requestAnimationFrame(S),p.bindFramebuffer(p.FRAMEBUFFER,r.renderState.baseLayer.framebuffer),t(`passthroughFullyObscured = ${r.renderState.passthroughFullyObscured}`),t(`baseLayer = ${r.renderState.baseLayer?.toString()}`),t(`session.renderState.baseLayer!.framebuffer = ${r.renderState.baseLayer.framebuffer.toString()}`)}function v(e){e.updateRenderState({baseLayer:new c(e,p)}),e.requestAnimationFrame(S)}async function f(){let e=await g("immersive-ar",["unbounded"],["camera-access"],[]);t(`running frame rate = ${e.frameRate}`),["end","inputsourceschange","select","selectstart","selectend","squeeze","squeezestart","squeezeend","visibilitychange","frameratechange"].forEach(n=>{e.addEventListener(n,o=>{t(`${o.type} > ${o.target} at ${o.timeStamp}`),n==="end"&&m.set("immersive-ar",null)})}),m.set("immersive-ar",e);let r=e.supportedFrameRates.at(-1);try{await e.updateTargetFrameRate(r)}catch(n){t(`session.updateTargetFrameRate(${r}) > error ${n.toString()}`)}v(e)}async function h(){l("xr-spatial-tracking")?t("xr-spatial-tracking is supported"):t("xr-spatial-tracking is not supported"),await u("immersive-ar"),await u("immersive-vr"),s.xr.addEventListener("devicechange",()=>{t("devicechange")}),s.userActivation.hasBeenActive?await f():i.querySelector(".enter").addEventListener("click",async()=>{await f()})}h();})();
