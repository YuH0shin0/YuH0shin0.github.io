"use strict";(()=>{var i=window.document;var l=window.navigator;var m=class{constructor(t,n,o){return new window.XRWebGLLayer(t,n,o)}};function r(e){let t=document.getElementsByClassName("console-dom").item(0);t.textContent+=`${e}.    `}async function p(e){await l.xr.isSessionSupported(e)?r(`${e} is supported`):r(`${e} is not supported`)}async function d(e,t,n){try{return await l.xr.requestSession("immersive-ar",{requiredFeatures:[...e],optionalFeatures:[...t,...n],depthSensing:{usagePreference:["cpu-optimized","gpu-optimized"],dataFormatPreference:["luminance-alpha","float32"]}})}catch(o){throw r(`requestSession error = ${o.toString()}`),new Error(o.toString())}}var f=new Set,S=new Set,g=new Set;function u(e,t){t.addEventListener("click",n=>{let o=n.target;o.checked?e.add(o.value):e.delete(o.value),document.dispatchEvent(new CustomEvent("dispatchRequestSession"))})}function v(e){e.addEventListener("click",t=>{t.isTrusted&&t.target.previousElementSibling.click()})}function L(e){document.addEventListener("dispatchRequestSession",async s=>{let y=await d(Array.from(f),Array.from(S),Array.from(g));await e(y)}),document.querySelectorAll(".label").forEach(s=>{v(s)}),document.querySelectorAll(".required-features").forEach(s=>{u(f,s)}),document.querySelectorAll(".optional-features").forEach(s=>{u(S,s)}),document.querySelectorAll(".module").forEach(s=>{u(g,s)})}function E(e){return i.featurePolicy.allowsFeature(e,window.origin)}var w=i.createElement("canvas"),a=w.getContext("webgl2",{xrCompatible:!0});a.viewport(0,0,a.canvas.width,a.canvas.height);a.clearColor(0,0,0,0);a.clear(a.COLOR_BUFFER_BIT);var c=new Map;c.set("inline",null);c.set("immersive-ar",null);c.set("immersive-vr",null);function R(e,t){let n=t.session;n.requestAnimationFrame(R),a.bindFramebuffer(a.FRAMEBUFFER,n.renderState.baseLayer.framebuffer)}async function b(e,t){c.set(t,e),e.addEventListener("end",()=>{c.delete(t),r("SESSION END")}),e.updateRenderState({baseLayer:new m(e,a)}),e.requestAnimationFrame(R)}async function T(){E("xr-spatial-tracking")?r("xr-spatial-tracking is supported"):r("xr-spatial-tracking is not supported"),r("\u6A5F\u80FD\u78BA\u8A8D"),L(b),await p("immersive-ar")}T();})();
