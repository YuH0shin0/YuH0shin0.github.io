"use strict";(()=>{var i=window.document;var s=window.navigator;var m=class{constructor(a,r,n){return new window.XRWebGLLayer(a,r,n)}};function t(e){let a=document.getElementsByClassName("console-dom").item(0);a.textContent+=`${e}.    `}async function u(e){await s.xr.isSessionSupported(e)?t(`${e} is supported`):t(`${e} is not supported`)}function l(e){return i.featurePolicy.allowsFeature(e,window.origin)}async function g(e,a,r,n){let o={requiredFeatures:[...a],optionalFeatures:[...r,...n]};n.includes("depth-sensing")&&(o.depthSensing={usagePreference:["cpu-optimized","gpu-optimized"],dataFormatPreference:["luminance-alpha","float32"]}),Object.freeze(o);try{return await s.xr.requestSession(e,o)}catch(d){throw t(`requestSession error = ${d.toString()}`),new Error(d.toString())}}var S=i.createElement("canvas"),c=S.getContext("webgl2",{xrCompatible:!0}),p=new Map;p.set("inline",null);p.set("immersive-ar",null);p.set("immersive-vr",null);function f(e,a){let r=a.session;r.requestAnimationFrame(f),c.bindFramebuffer(c.FRAMEBUFFER,r.renderState.baseLayer.framebuffer),t(`passthroughFullyObscured = ${r.renderState.passthroughFullyObscured}`),t(`baseLayer = ${r.renderState.baseLayer?.toString()}`),t(`session.renderState.baseLayer!.framebuffer = ${r.renderState.baseLayer.framebuffer.toString()}`)}function y(e){e.updateRenderState({baseLayer:new m(e,c)}),e.requestAnimationFrame(f)}async function h(){if(l("xr-spatial-tracking")?t("xr-spatial-tracking is supported"):t("xr-spatial-tracking is not supported"),await u("immersive-ar"),await u("immersive-vr"),s.xr.addEventListener("devicechange",()=>{t("devicechange")}),await s.xr.isSessionSupported("immersive-ar")){let e=await g("immersive-ar",["unbounded"],[],[]);t(`running frame rate = ${e.frameRate}`),["end","inputsourceschange","select","selectstart","selectend","squeeze","squeezestart","squeezeend","visibilitychange","frameratechange"].forEach(n=>{e.addEventListener(n,o=>{t(`${o.type} > ${o.target} at ${o.timeStamp}`),n==="end"&&p.set("immersive-ar",null)})}),p.set("immersive-ar",e);let r=e.supportedFrameRates.at(-1);try{await e.updateTargetFrameRate(r)}catch(n){t(`session.updateTargetFrameRate(${r}) > error ${n.toString()}`)}y(e)}}h();})();
