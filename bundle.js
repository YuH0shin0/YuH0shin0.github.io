"use strict";(()=>{var u=window.document;var l=window.navigator;var c=class{constructor(a,r,i){return new window.XRWebGLLayer(a,r,i)}};function t(e){let a=document.getElementsByClassName("console-dom").item(0);a.textContent+=`${e}.    `}async function m(e){await l.xr.isSessionSupported(e)?t(`${e} is supported`):t(`${e} is not supported`)}async function d(e,a){try{return a.includes("depth-sensing")?await l.xr.requestSession("immersive-ar",{requiredFeatures:[...e,...a],optionalFeatures:["layers","space-warp","camera-access"],depthSensing:{usagePreference:["cpu-optimized","gpu-optimized"],dataFormatPreference:["luminance-alpha","float32"]}}):await l.xr.requestSession("immersive-ar",{requiredFeatures:[...e,...a],optionalFeatures:["layers","space-warp","camera-access"]})}catch(r){throw t(`requestSession error = ${r.toString()}`),new Error(r.toString())}}function f(e){let a=new Set,r=new Set;document.querySelectorAll(".label").forEach(o=>{o.addEventListener("click",n=>{n.isTrusted&&n.target.previousElementSibling.click()})}),document.addEventListener("dispatchReferenceType",async o=>{let n=await d(Array.from(a),Array.from(r));await e(n)}),document.addEventListener("dispatchModule",async o=>{let n=await d(Array.from(a),Array.from(r));await e(n)}),document.querySelectorAll(".referenceSpaceType").forEach(o=>{o.addEventListener("click",n=>{let s=n.target;s.checked?a.add(s.value):a.delete(s.value),document.dispatchEvent(new CustomEvent("dispatchReferenceType",{detail:a}))})}),document.querySelectorAll(".module").forEach(o=>{o.addEventListener("click",n=>{let s=n.target;s.checked?r.add(s.value):r.delete(s.value),document.dispatchEvent(new CustomEvent("dispatchModule",{detail:r}))})})}var y=u.createElement("canvas"),g=y.getContext("webgl2",{xrCompatible:!0}),p=new Map;p.set("inline",null);p.set("immersive-ar",null);p.set("immersive-vr",null);async function S(e){e.addEventListener("end",()=>{t("SESSION END")}),t(`enabledFeaures = ${e.enabledFeatures}`);try{await e.updateTargetFrameRate(120),t(`session.frameRate = ${e.frameRate}`)}catch(i){t(`updateTargetFrameRate > err = ${i.toString()}`)}let a={antialias:!0,depth:!0,stencil:!0,alpha:!0,ignoreDepthValues:!1,framebufferScaleFactor:1},r={depthNear:.1,depthFar:1e3,passthroughFullyObscured:!0,inlineVerticalFieldOfView:null,baseLayer:new c(e,g,a),layers:null};try{await e.updateRenderState(r),t(`passthroughFullyObscured = ${e.renderState.passthroughFullyObscured}`),t(`baseLayer = ${e.renderState.baseLayer}`)}catch(i){t(`updateRenderState > err = ${i.toString()}`)}}async function v(){u.featurePolicy.allowsFeature("xr-spatial-tracking")?t("xr-spatial-tracking is supported"):t("xr-spatial-tracking is not supported"),t("\u6A5F\u80FD\u78BA\u8A8D"),f(S),await m("inline"),await m("immersive-vr"),await m("immersive-ar")}v();})();
