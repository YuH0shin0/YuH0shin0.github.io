"use strict";(()=>{var d=window.document;var c=window.navigator;var p=class{constructor(i,n,u){return new window.XRWebGLLayer(i,n,u)}};function e(s){let i=d.getElementsByClassName("console-dom").item(0);i.textContent+=`${s}\r
`}var y="unbounded";async function v(){let s=d.querySelector(".enter > button");s.textContent=s.classList.toString(),s.addEventListener("click",async i=>{if(!i.isTrusted)return;let n=await c.xr.requestSession("immersive-ar",{requiredFeatures:[y,"depth-sensing","hand-tracking","body-tracking"],optionalFeatures:["secondary-views"],depthSensing:{usagePreference:["cpu-optimized","gpu-optimized"],dataFormatPreference:["luminance-alpha","float32"]}}),u={antialias:!0,depth:!0,stencil:!0,alpha:!0,ignoreDepthValues:!1,framebufferScaleFactor:1},g=new p(n,new WebGL2RenderingContext,u),$={depthFar:1e3,depthNear:.1,passthroughFullyObscured:!1,inlineVerticalFieldOfView:Math.PI*.5,baseLayer:g};n.updateRenderState($);let m=await n.requestReferenceSpace(y);n.requestAnimationFrame((t,a)=>{e(`frameCallback of requestAnimationFrame(${t}, ${a})`),e(`session = ${a.session}`),e(`predictedDisplayTime = ${a.predictedDisplayTime}`),e(`bodyTracking = ${a.body}`);let r=a.getViewerPose(m);if(r){e(`emulatedPosition = ${r.emulatedPosition}`),e(`angularVelocity = ${r.angularVelocity}`),e(`linearVelocity = ${r.linearVelocity}`);for(let l of r.views)e(`view.eye = ${l.eye}`),e(`view.recommendedViewportScale = ${l.recommendedViewportScale}`),e(`view.requestViewportScale = ${l.requestViewportScale}`);e(`views = ${r?.views}`)}else e(`xrViewerPose = ${JSON.stringify(r)}`)}),e(`WebXR Depth Sensing Module = session.depthUsage = ${n.depthUsage}`),e(`WebXR Depth Sensing Module = session.depthDataFormat = ${n.depthDataFormat}`),e(`WebXR Depth Sensing Module = session.depthType = ${n.depthType}`),e(`WebXR Depth Sensing Module = session.depthActive = ${n.depthActive}`),e(`WebXR Depth Sensing module = session.resumeDepthSensing() = ${n.resumeDepthSensing()}`),n.addEventListener("onend",t=>{t.isTrusted&&e(`event = ${t.type}(${t.target})`)}),n.addEventListener("onframeratechange",t=>{t.isTrusted&&e(`event = ${t.type}(${t.target})`)}),n.addEventListener("oninputsourceschange",t=>{t.isTrusted&&e(`event = ${t.type}(${t.target})`)}),n.addEventListener("onselect",t=>{t.isTrusted&&e(`event = ${t.type}(${t.target})`)}),n.addEventListener("onselectend",t=>{t.isTrusted&&e(`event = ${t.type}(${t.target})`)}),n.addEventListener("onselectstart",t=>{t.isTrusted&&e(`event = ${t.type}(${t.target})`)}),n.addEventListener("onsqueeze",t=>{t.isTrusted&&e(`event = ${t.type}(${t.target})`)}),n.addEventListener("onsqueezeend",t=>{t.isTrusted&&e(`event = ${t.type}(${t.target})`)}),n.addEventListener("onvisibilitychange",t=>{t.isTrusted&&e(`event = ${t.type}(${t.target})`)}),e(`session.enabledFeatures = ${n.enabledFeatures}`),e(`session.supportedFrameRates = ${n.supportedFrameRates}`),e(`session.frameRate = ${n.frameRate}`),e(`session.inputSources = ${JSON.stringify(n.inputSources)}`),n.inputSources.forEach(t=>{e(`inputSource.gripSpace = ${t.gripSpace}`);let a=t.gripSpace;e(`${a?.toString()}`),e(`inputSource.handedness = ${t.handedness}`),e(`inputSource.profiles = ${t.profiles}`),e(`inputSource.skipRendering = ${t.skipRendering}`),e(`inputSource.targetRayMode = ${t.targetRayMode}`),e(`inputSource.targetRaySpace = ${t.targetRaySpace}`),e(`${t?.targetRaySpace.toString()}`),t.hand&&(e(`hand = ${t.hand.size}`),e(`wrist = ${t.hand.get("wrist").jointName}`))}),e(`session.isSystemKeyboardSupported = ${n.isSystemKeyboardSupported}`),e(`session.renderState = ${JSON.stringify(n.renderState)}`),e(`session.visibilityState = ${n.visibilityState}`);let o=n.renderState;e(`renderState.baseLayer = ${o.baseLayer}`),e(`renderState.depthFar = ${o.depthFar}`),e(`renderState.depthNear = ${o.depthNear}`),e(`renderState.inlineVerticalFieldOfView = ${o.inlineVerticalFieldOfView}`),e(`renderState.passthroughFullyObscured = ${o.passthroughFullyObscured}`),e(`WebXR AR module = session.environmentBlendMode = ${n.environmentBlendMode}`),e(`WebXR AR module = session.environmentBlendMode = ${n.interactionMode}`)})}async function S(){d.featurePolicy.allowsFeature("xr-spatial-tracking")?e("xr-spatial-tracking is supported"):e("xr-spatial-tracking is not supported"),c.xr.addEventListener("ondevicechange",s=>{s.isTrusted&&e(`event = ${s.type}(${s.target})`)}),e("\u6A5F\u80FD\u78BA\u8A8D"),await v()}S();})();
